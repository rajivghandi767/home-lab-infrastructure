groups:
  # Portfolio Website Alerts
  - name: portfolio.rules
    rules:
      - alert: PortfolioBackendDown
        expr: up{job="portfolio-backend"} == 0
        for: 1m
        labels:
          severity: critical
          service: portfolio
        annotations:
          summary: "游댮 Portfolio Backend API is DOWN"
          description: "Django backend at portfolio-api.rajivwallace.com unreachable for over 1 minute"

      - alert: PortfolioHighResponseTime
        expr: django_http_requests_latency_seconds_by_view_method{quantile="0.95"} > 0.5
        for: 2m
        labels:
          severity: warning
          service: portfolio
        annotations:
          summary: "游리 Portfolio Slow Response Times"
          description: "95th percentile response time is {{ $value }}s (above 500ms)"

      - alert: PortfolioHighErrorRate
        expr: rate(django_http_responses_total_by_status_total{status=~"5.."}[5m]) / rate(django_http_responses_total_by_status_total[5m]) * 100 > 5
        for: 3m
        labels:
          severity: warning
          service: portfolio
        annotations:
          summary: "游리 Portfolio High Error Rate"
          description: "Error rate is {{ $value | printf \"%.2f\" }}% (above 5%)"

  # System Resource Alerts
  - name: system.rules
    rules:
      - alert: RaspberryPiHighCPU
        expr: 100 - (avg by (instance) (irate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 80
        for: 5m
        labels:
          severity: warning
          service: system
        annotations:
          summary: "游리 High CPU Usage"
          description: "CPU usage is {{ $value | printf \"%.2f\" }}%"

      - alert: RaspberryPiHighMemory
        expr: (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100 > 85
        for: 3m
        labels:
          severity: warning
          service: system
        annotations:
          summary: "游리 High Memory Usage"
          description: "Memory usage is {{ $value | printf \"%.2f\" }}%"

      - alert: RaspberryPiLowDiskSpace
        expr: (node_filesystem_avail_bytes{mountpoint="/"} / node_filesystem_size_bytes{mountpoint="/"}) * 100 < 15
        for: 1m
        labels:
          severity: critical
          service: system
        annotations:
          summary: "游댮 Low Disk Space"
          description: "Only {{ $value | printf \"%.2f\" }}% disk space remaining"

  # Database Alerts
  - name: database.rules
    rules:
      - alert: PostgreSQLDown
        expr: up{job="postgres"} == 0
        for: 1m
        labels:
          severity: critical
          service: database
        annotations:
          summary: "游댮 PostgreSQL Database Down"
          description: "PostgreSQL database is unreachable"

  # Docker Alerts
  - name: docker.rules
    rules:
      - alert: DockerContainerDown
        expr: up{job="cadvisor"} == 0
        for: 1m
        labels:
          severity: warning
          service: docker
        annotations:
          summary: "游리 Docker Monitoring Down"
          description: "Container monitoring (cAdvisor) is unreachable"

    # Jenkins Alerts
  - name: jenkins.rules
    rules:
      - alert: JenkinsDown
        expr: up{job="jenkins"} == 0
        for: 2m
        labels:
          severity: critical
          service: jenkins
        annotations:
          summary: "游댮 Jenkins is DOWN"
          description: "Jenkins CI/CD server unreachable for over 2 minutes"

      - alert: JenkinsJobFailures
        expr: increase(jenkins_builds_failure_total[1h]) > 3
        for: 0m
        labels:
          severity: warning
          service: jenkins
        annotations:
          summary: "游리 Jenkins Job Failures"
          description: "{{ $value }} Jenkins jobs failed in the last hour"